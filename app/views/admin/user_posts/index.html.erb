<h2 class="mb-3 text-center">ユーザー投稿一覧</h2>

<!-- フィルター -->
<div class="d-flex align-items-center mb-2 ml-2">
  <strong class="me-2">表示：</strong>
  <% show_param = params[:show] %>
  <% show_deleted = ActiveModel::Type::Boolean.new.cast(params[:show_deleted]) %>
  <% show_non_public = ActiveModel::Type::Boolean.new.cast(params[:show_non_public]) %>

  <% if show_param == "all" %>
    <%= link_to '公開中のみ表示', admin_user_posts_path, class: "me-2" %>
  <% else %>
    <%= link_to 'すべて表示', admin_user_posts_path(show: "all"), class: "me-2" %>
  <% end %>

  <span class="mx-1">｜</span>

  <% if show_non_public %>
    <%= link_to '非公開を非表示', admin_user_posts_path(show_deleted: show_deleted), class: "me-2" %>
  <% else %>
    <%= link_to '非公開を表示', admin_user_posts_path(show_deleted: show_deleted, show_non_public: true), class: "me-2" %>
  <% end %>

  <span class="mx-1">｜</span>

  <% if show_deleted %>
    <%= link_to '削除済みを非表示', admin_user_posts_path(show_non_public: show_non_public), class: "me-2" %>
  <% else %>
    <%= link_to '削除済みを表示', admin_user_posts_path(show_non_public: show_non_public, show_deleted: true), class: "me-2" %>
  <% end %>
</div>

<% current_direction = params[:direction] == "asc" ? "asc" : "desc" %>
<% current_show = params[:show] %>
<% current_show_non_public = params[:show_non_public] %>
<% current_show_deleted = params[:show_deleted] %>

<div class="d-flex align-items-center mb-4 ml-2">
<strong class="me-2">並び順：</strong>
  
<%= link_to '新しい順', admin_user_posts_path( direction: "desc", show: current_show,
  show_non_public: current_show_non_public, show_deleted: current_show_deleted), 
    class: "me-2 #{current_direction == 'desc' ? 'fw-bold' : ''}" %>

<span class="mx-1">｜</span>

<%= link_to '古い順', admin_user_posts_path(direction: "asc", show: current_show,
  show_non_public: current_show_non_public, show_deleted: current_show_deleted), 
    class: "#{current_direction == 'asc' ? 'fw-bold' : ''}" %>
</div>

<!-- 投稿一覧 -->
<table class="table table-hover table-bordered">
  <thead class="text-center thead-light">
    <tr>
      <th style="width: 10%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">ID</th>
      <th style="width: 35%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">タイトル</th>
      <th style="width: 15%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">ニックネーム</th>
      <th style="width: 10%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">ステータス</th>
      <th style="width: 20%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">投稿日時</th>
      <th style="width: 10%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">詳細</th>
    </tr>
  </thead>
  <tbody>
    <% @user_posts.each do |post| %>
      <tr class="text-center <%= row_class(post) %>">
        <td><%= post.id %></td>
        <td><%= post.title %></td>
        <td><%= post.user.nickname %></td>
        <td><%= status_label(post) %></td>
        <td><%= post.created_at.strftime('%Y-%m-%d %H:%M') %></td>
        <td><%= link_to '詳細', admin_user_post_path(post) %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<div class="d-flex justify-content-center mt-4">
  <%= paginate @user_posts %>
</div>